(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1661:(e,t,n)=>{Promise.resolve().then(n.bind(n,2713))},2713:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var a=n(5155),l=n(5083),o=n(5541);let r=o.sh.createBlockDefinitionsFromJsonArray([{type:"io_read_line",tooltip:"Read Line",helpUrl:"",message0:"read line",output:"String",colour:270},{type:"io_puts",tooltip:"Print",helpUrl:"",message0:"puts %1",args0:[{type:"input_value",name:"VALUE",check:"String"}],previousStatement:null,nextStatement:null,colour:270},{type:"io_read_numbers",tooltip:"Read multiple numbers",helpUrl:"",message0:"read numbers of line",output:"Array",colour:270}]);o.sh.defineBlocks(r);let i=o.sh.createBlockDefinitionsFromJsonArray([{type:"string_slice",tooltip:"Get slice from array",helpUrl:"",message0:"slice %1 from %2",args0:[{type:"input_value",name:"String",check:"String"},{type:"field_input",name:"Range",check:"String"}],output:"String",colour:270}]);o.sh.defineBlocks(i);let c=o.sh.createBlockDefinitionsFromJsonArray([{type:"array_get_index",tooltip:"Get an item from array",helpUrl:"",message0:"get item %1 from array %2",args0:[{type:"field_input",name:"Index",check:"Number",text:"0"},{type:"input_value",name:"Array",check:"Array"}],output:"String",colour:270},{type:"array_slice",tooltip:"Get slice from array",helpUrl:"",message0:"slice %1 from %2",args0:[{type:"input_value",name:"Array",check:"Array"},{type:"field_input",name:"Range",check:"String"}],output:"Array",colour:270}]);o.sh.defineBlocks(c),Object.assign({},r,i,c);var s=n(2115);class u extends o.jZ{getReservedWords(){return this.RESERVED_WORDS_}getDefinitions(){return this.definitions_||{}}setDefinitions(e){this.definitions_=e}setFunctionNames(e){this.functionNames_=e}resetNameDB(){this.nameDB_&&this.nameDB_.reset()}quote_(e){return'"'.concat(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"')}}let d=new u("Ruby"),p={ATOMIC:0,EXPONENTIATION:3,MULTIPLICATIVE:5,ADDITIVE:6,RELATIONAL:11,NONE:99};for(let[e,t]of(d.init=e=>{d.nameDB_=new o.fS(d.getReservedWords()),d.nameDB_.setVariableMap(e.getVariableMap()),d.setDefinitions(Object.create({})),d.setFunctionNames(Object.create({}))},d.finish=e=>{let t=Object.values(d.getDefinitions()||{}).join("\n");return d.resetNameDB(),[t,e].filter(Boolean).join("\n\n")},d.scrub_=(e,t)=>{var n;let a=e.getCommentText(),l=a?d.prefixLines("# ".concat(a),""):"",o=null==(n=e.nextConnection)?void 0:n.targetBlock();return l+t+(o?d.blockToCode(o):"")},Object.entries({io_read_line:()=>["gets.chomp",p.ATOMIC],io_puts:(e,t)=>{let n=t.valueToCode(e,"VALUE",p.NONE)||'""';return"puts ".concat(n,"\n")},io_read_numbers:()=>["gets.chomp.split.map(&:to_i)",p.ATOMIC],variables_set:(e,t)=>{let n=t.valueToCode(e,"VALUE",p.NONE)||"0";return t.getVariableName(e.getFieldValue("VAR"))+" = "+n+"\n"},variables_get:(e,t)=>[t.getVariableName(e.getFieldValue("VAR")),p.ATOMIC],text:(e,t)=>{let n=e.getFieldValue("TEXT")||"";return[t.quote_(n),p.ATOMIC]},string_slice:(e,t)=>{let n=t.valueToCode(e,"String",p.NONE)||'""',a=e.getFieldValue("Range")||"0..-1";return["".concat(n,"[").concat(a,"]"),p.ATOMIC]},controls_if:(e,t)=>{let n=t.valueToCode(e,"IF0",p.NONE)||"false",a=t.statementToCode(e,"DO0")||"",l="if ".concat(n," then\n").concat(a),o=1;for(;e.getInput("IF".concat(o));){let n=t.valueToCode(e,"IF".concat(o),p.NONE)||"false",a=t.statementToCode(e,"DO".concat(o))||"";l+="\nelsif ".concat(n," then\n").concat(a),o++}let r=t.statementToCode(e,"ELSE");return r&&(l+="\nelse\n".concat(r)),l+="\nend"},logic_compare:(e,t)=>{let n={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],a=t.valueToCode(e,"A",p.RELATIONAL)||"0",l=t.valueToCode(e,"B",p.RELATIONAL)||"0";return["".concat(a," ").concat(n," ").concat(l),p.RELATIONAL]},math_arithmetic:(e,t)=>{let n={ADD:["+",p.ADDITIVE],MINUS:["-",p.ADDITIVE],MULTIPLY:["*",p.MULTIPLICATIVE],DIVIDE:["/",p.MULTIPLICATIVE],POWER:["**",p.EXPONENTIATION]}[e.getFieldValue("OP")],a=t.valueToCode(e,"A",n[1])||"0",l=t.valueToCode(e,"B",n[1])||"0";return["".concat(a," ").concat(n[0]," ").concat(l),n[1]]},array_get_index:(e,t)=>{let n=t.valueToCode(e,"Array",p.NONE)||"[]",a=e.getFieldValue("Index")||"0";return["".concat(n,"[").concat(a,"]"),p.ATOMIC]},array_slice:(e,t)=>{let n=t.valueToCode(e,"Array",p.NONE)||"[]",a=e.getFieldValue("Range")||"0..-1";return["".concat(n,"[").concat(a,"]"),p.ATOMIC]}})))d.forBlock[e]=t;var m=n(3603);let g=(0,n(5028).default)(()=>n.e(215).then(n.bind(n,9215)),{loadableGenerated:{webpack:()=>[null]},ssr:!1});function b(){let e=(0,s.useRef)(null),{workspace:t}=(0,l.P2)({ref:e,initialXml:"<xml></xml>",toolboxConfiguration:y,workspaceConfiguration:{}}),[n,o]=(0,s.useState)(!1),[r,i]=(0,s.useState)(""),c=(0,s.useCallback)(()=>{t&&(console.log("Generating code from Blockly workspace:",t),i(d.workspaceToCode(t)),o(!0))},[t]),u=(0,s.useCallback)(()=>{r&&(console.log(r),navigator.clipboard.writeText(r))},[r]);return(0,a.jsxs)("div",{className:"h-dvh flex flex-col",children:[(0,a.jsxs)("header",{className:"p-2 flex justify-between border-b",children:["Ruby Block Editor",(0,a.jsx)("button",{className:"rounded-lg",onClick:()=>c(),children:"Gen Ruby Code"})]}),(0,a.jsx)("div",{className:"flex-1 z-0",children:(0,a.jsx)("div",{ref:e,className:"w-full h-full"})}),n&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 bg-white flex flex-col",children:[(0,a.jsxs)("div",{className:"p-2 flex items-center justify-between border-b bg-black",style:{paddingBottom:"calc(env(safe-area-inset-bottom)/4)"},children:[(0,a.jsx)("span",{children:"Ruby コード"}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)("button",{onClick:u,children:"コピー"}),(0,a.jsx)("button",{onClick:()=>o(!1),children:"閉じる"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(g,{value:r,className:"h-full bg-gray-100 text-gray-800",extensions:[m.Lz.editable.of(!1),m.Lz.lineWrapping],basicSetup:{highlightActiveLine:!1,highlightActiveLineGutter:!1,foldGutter:!0,lineNumbers:!0},readOnly:!0,theme:void 0})})]})]})}let y='\n<xml>\n  <category name="IO">\n    <block type="io_read_line"/>\n    <block type="io_read_numbers"/>\n    <block type="io_puts"/>\n  </category>\n  <category name="リテラル">\n    <block type="text"/>\n  </category>\n  <category name="値/演算">\n\x3c!--    <block type="math_number"/>--\x3e\n    <block type="variables_set"/>\n    <block type="variables_get"/>\n    <block type="string_slice"/>\n    <block type="math_arithmetic"/>\n    <block type="array_get_index"/>\n    <block type="array_slice"/>\n\x3c!--    <block type="logic_compare"/>--\x3e\n\x3c!--    <block type="text_join"/>--\x3e\n  </category>\n  <category name="制御">\n    <block type="controls_if"/>\n    <block type="logic_compare"/>\n  </category>\n</xml>\n'}},e=>{e.O(0,[79,263,754,441,964,358],()=>e(e.s=1661)),_N_E=e.O()}]);